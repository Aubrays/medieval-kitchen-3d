<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/icon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A medieval kitchen</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.rawgit.com/mattatz/THREE.Fire/master/FireShader.js"></script>
    <script src="https://cdn.rawgit.com/mattatz/THREE.Fire/master/Fire.js"></script>
  </head>
  <body>
    <div id="app">
      <a-scene>
        <!-- Asset management system -->
        <a-assets>
          <a-asset-item
            id="floor_tile_large"
            src="assets/Kaykit_dungeon/floor_tile_large.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="pillar"
            src="assets/Kaykit_dungeon/pillar.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall"
            src="assets/Kaykit_dungeon/wall.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_half"
            src="assets/Kaykit_dungeon/wall_half.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_arched"
            src="assets/Kaykit_dungeon/wall_arched.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_arched_window"
            src="assets/Kaykit_dungeon/wall_archedwindow_open.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_corner"
            src="assets/Kaykit_dungeon/wall_corner.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_corner_small"
            src="assets/Kaykit_dungeon/wall_corner_small.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_doorway"
            src="assets/Kaykit_dungeon/wall_doorway.glb"
          ></a-asset-item>

          <a-mixin id="checkpoint"></a-mixin>
          <a-mixin id="checkpoint-hovered" color="#6CEEB5"></a-mixin>
        </a-assets>

        <!-- Player -->
        <a-entity id="rig" movement-controls="controls: checkpoint" checkpoint-controls="mode: animate" position="0 0 16" rotation="0 -90 0">
          <a-entity camera
                    position="0 1.6 0"
                    look-controls="pointerLockEnabled: true">
            <a-entity cursor
                      raycaster="objects:[checkpoint]"
                      position="0 0 -1"
                      geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03;"
                      material="color: #CCC; shader: flat;"></a-entity>
          </a-entity>
        </a-entity>

        <a-entity light="type: ambient; color: #444"></a-entity>

        <a-sky color="#050724"></a-sky>

        <a-entity floor></a-entity>
        <a-entity pillars></a-entity>
        <a-entity walls></a-entity>
        <a-entity fire></a-entity>

        <!-- Wall North -->
        <a-gltf-model
          src="#wall_doorway"
          position="-2 0 16"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_half"
          position="-2 0 14"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched"
          position="-2 0 10 "
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched"
          position="-2 0 6"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall"
          position="-2 0 2"
          rotation="0 90 0"
        ></a-gltf-model>

        <!-- Wall East -->
        <a-gltf-model src="#wall" position="2 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall_arched" position="6 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall_arched" position="10 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall" position="14 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall_half" position="16 0 -2"></a-gltf-model>

        <!-- Wall South -->
        <a-gltf-model
          src="#wall_doorway"
          position="18 0 0"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_half"
          position="18 0 2"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched"
          position="18 0 6"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched"
          position="18 0 10"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall"
          position="18 0 14"
          rotation="0 270 0"
        ></a-gltf-model>

        <!-- Wall West -->
        <a-gltf-model
          src="#wall_half"
          position="0 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="2 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="6 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="10 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="14 0 18"
          rotation="0 180 0"
        ></a-gltf-model>

        <!-- Wall Corners WN to SW--->
        <a-gltf-model
          src="#wall_corner_small"
          position="-2 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner"
          position="-2 0 -2"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner_small"
          position="18 0 -2"
          rotation="0 0 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner"
          position="18 0 18"
          rotation="0 270 0"
        ></a-gltf-model>

        <!-- Checkpoints -->
        <a-entity position="0 0 0">
          <a-cylinder checkpoint radius="1" height="0.2" position="0 0 16" color="#39BB82"></a-cylinder>
          <a-cylinder checkpoint radius="1" height="0.2" position="3 0 0" color="#39BB82"></a-cylinder>
          <a-cylinder checkpoint radius="1" height="0.2" position="-3 0 0" color="#39BB82"></a-cylinder>
        </a-entity>

      </a-scene>
    </div>
    <script type="module" src="/main.js"></script>
  </body>
</html>
