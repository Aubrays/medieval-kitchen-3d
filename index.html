<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/icon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A medieval kitchen</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <div id="app">

      <div id="UI" style="z-index: 1000; position: fixed; margin: 1rem;">
        <div style="border:1px solid black; background-color: rgba(75, 2, 59, 0.363); margin:auto">
          <button id="start-exp">Commencer</button>
        </div>
      </div>


      <a-scene background="color: #050724;">
        <!-- start Asset management system -->
        <a-assets>
          <!-- start Walls Models-->
          <a-asset-item
            id="floor_tile_large"
            src="assets/Kaykit_dungeon/floor_tile_large.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="pillar"
            src="assets/Kaykit_dungeon/pillar.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall"
            src="assets/Kaykit_dungeon/wall.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_half"
            src="assets/Kaykit_dungeon/wall_half.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_arched_window"
            src="assets/Kaykit_dungeon/wall_archedwindow_open.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_corner"
            src="assets/Kaykit_dungeon/wall_corner.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_corner_small"
            src="assets/Kaykit_dungeon/wall_corner_small.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="wall_doorway"
            src="assets/Kaykit_dungeon/wall_doorway.glb"
          ></a-asset-item>
          <a-asset-item
            id="arched_chimney"
            src="assets/Kaykit_dungeon/arched_chimney.glb"
          ></a-asset-item>
          <!-- end Walls Models-->

          <!-- start Accessories Models -->
          <a-asset-item id="log" src="assets/log/log.glb"></a-asset-item>
          <a-asset-item
            id="keg_decorated"
            src="assets/Kaykit_dungeon/keg_decorated.gltf.glb"
          ></a-asset-item>
          <a-asset-item
            id="table_long"
            src="assets/Kaykit_dungeon/table_long.gltf.glb"
          ></a-asset-item>
          <!-- end Accessories Models -->
          

          <!-- Audios-->
          <audio
            id="crackling-fire"
            src="assets/sounds/crackling-fire.ogg"
            preload="auto"
          ></audio>

          <audio
            id="music"
            src="assets/sounds/a_night_s_respite.ogg"
            preload="auto"
          ></audio>

          <a-mixin id="checkpoint"></a-mixin>
          <a-mixin id="checkpoint-hovered" color="#6CEEB5"></a-mixin>
        </a-assets>
        <!-- end Asset management system -->

        <a-sound
          id="ambient-sound"
          src="#music"
          autoplay="true"
          loop="true"
        ></a-sound>

        <!-- start Player -->
        <a-entity
          id="rig"
          movement-controls="controls: checkpoint"
          checkpoint-controls="mode: animate"
          position="0 0 16"
          rotation="0 -90 0"
        >
          <a-entity
            camera
            position="0 1.6 0"
            look-controls="pointerLockEnabled: true"
          >
            <a-entity
              cursor
              raycaster="objects:[checkpoint]"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03;"
              material="color: #CCC; shader: flat;"
            ></a-entity>
          </a-entity> </a-entity
        ><!-- end Player -->

        <a-entity floor></a-entity>
        <a-entity pillars></a-entity>
        <a-entity walls></a-entity>

        <!-- Wall North -->
        <a-gltf-model
          shadow="receive: false; cast:true;"
          src="#wall_doorway"
          position="-2 0 16"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          shadow="receive: false; cast:true;"
          src="#wall_half"
          position="-2 0 14"
          rotation="0 90 0"
        ></a-gltf-model>

        <a-entity
          gltf-model="#arched_chimney"
          material="transparent: false; opacity: 1.0;"
          shadow="receive: false; cast:true;"
          position="-2 0 10"
          rotation="0 90 0"
        ></a-entity>
        <!-- <a-gltf-model
            shadow="receive: false; cast:true;"
            src="#arched_chimney"
            position="-2 0 10 "
            rotation="0 90 0"
            transparent="0"
          ></a-gltf-model> -->
        <a-gltf-model
          src="#arched_chimney"
          position="-2 0 6"
          rotation="0 90 0"
          shadow="receive: false; cast:true;"
        ></a-gltf-model>
        <a-gltf-model
          shadow="receive: false; cast:true;"
          src="#wall"
          position="-2 0 2"
          rotation="0 90 0"
        ></a-gltf-model>

        <!-- Wall East -->
        <a-gltf-model src="#wall" position="2 0 -2"></a-gltf-model>
        <a-gltf-model src="#arched_chimney" position="6 0 -2"></a-gltf-model>
        <a-gltf-model src="#arched_chimney" position="10 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall" position="14 0 -2"></a-gltf-model>
        <a-gltf-model src="#wall_half" position="16 0 -2"></a-gltf-model>

        <!-- Wall South -->
        <a-gltf-model
          src="#wall_doorway"
          position="18 0 0"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_half"
          position="18 0 2"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#arched_chimney"
          position="18 0 6"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#arched_chimney"
          position="18 0 10"
          rotation="0 270 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall"
          position="18 0 14"
          rotation="0 270 0"
        ></a-gltf-model>

        <!-- Wall West -->
        <a-gltf-model
          src="#wall_half"
          position="0 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="2 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="6 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="10 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_arched_window"
          position="14 0 18"
          rotation="0 180 0"
        ></a-gltf-model>

        <!-- Wall Corners WN to SW--->
        <a-gltf-model
          src="#wall_corner_small"
          position="-2 0 18"
          rotation="0 180 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner"
          position="-2 0 -2"
          rotation="0 90 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner_small"
          position="18 0 -2"
          rotation="0 0 0"
        ></a-gltf-model>
        <a-gltf-model
          src="#wall_corner"
          position="18 0 18"
          rotation="0 270 0"
        ></a-gltf-model>

        <a-entity logs position="16 0.587 10"></a-entity>

        <!-- start FIRE -->
        <a-entity
          position="-1.725 0.587 10"
          sound="src: #crackling-fire; autoplay: true; loop: true; refDistance: 1; maxDistance: 12; rolloffFactor: 1; volume: 1; distanceModel: inverse;"
        >
        
        <a-entity logs></a-entity>

          <!-- Flames-->
          <a-entity
            triangle-fire="particles: 500;"
            position="0 -0.2 0"
          ></a-entity>

          <!-- start Light of flames-->
          <a-entity
            animation="property: position; dur: 223; to:0 0 0.05; loop:true; dir: alternate; easing: easeInOutQuad"
          >
            <a-entity
              position="0.0 0.6 0.0"
              animation="property: position; dur: 360; to: 0 0.65 0; loop:true; dir: alternate; easing: easeInOutQuad;"
            >
              <a-entity
                light="type: point; color: #FFA200; intensity: 5; distance: 20.0; castShadow: true; shadowCameraVisible: true; decay: 5;"
                animation="property: light.intensity; dur: 293; to:6; loop:true; dir:alternate; easing:easeInOutQuad;"
              >
              </a-entity>
            </a-entity>
          </a-entity>
          <!-- end Light of flames-->
        </a-entity>
        <!-- end FIRE -->

        <a-gltf-model
          src="#keg_decorated"
          position="13.75 0 -0.6"
          rotation="0 0 0"
          scale="0.75 0.75 0.75"
        ></a-gltf-model>

        <a-gltf-model
          src="#table_long"
          position="12 0 8"
          rotation="0 0 0"
          scale="1 0.8 1"
          shadow="cast:true; receive:true;"
        ></a-gltf-model>

        <a-gltf-model
          src="#table_long"
          position="4 0 8"
          rotation="0 0 0"
          scale="1 0.8 1"
          shadow="cast:true; receive:true;"
        ></a-gltf-model>

        <!-- Checkpoints -->
        <a-entity position="0 0 0">
          <a-cylinder
            checkpoint
            radius="1"
            height="0.2"
            position="0 0 16"
            color="#39BB82"
          ></a-cylinder>
          <a-cylinder
            checkpoint
            radius="1"
            height="0.2"
            position="3 0 0"
            color="#39BB82"
          ></a-cylinder>
          <a-cylinder
            checkpoint
            radius="1"
            height="0.2"
            position="-3 0 0"
            color="#39BB82"
          ></a-cylinder>
        </a-entity>

        <!-- Sky and ambient light -->
        <a-entity light="type: ambient; color: #444"></a-entity>

        <!-- <a-sky color="#050724"></a-sky> -->
      </a-scene>
    </div>
    <script type="module" src="/main.js"></script>
  </body>
</html>
